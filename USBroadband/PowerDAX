5G StdDev = STDEV.P('YourTableName'[mobilebb_5g_spd1_area_st_pct])

5G Speed 2 StdDev = STDEV.P('YourTableName'[mobilebb_5g_spd1_area_st_pct])
// Variance from Mean
5G Variance from Mean = 'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - [Avg 5G Speed1 Coverage]

// Above/Below Average Indicator
Above Average 5G = 
IF('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] > [Avg 5G Speed1 Coverage], 
   "Above Average", 
   "Below Average")

// Z-Score (standard deviations from mean)
5G Z-Score = 
DIVIDE(
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - [Avg 5G Speed1 Coverage],
    [5G StdDev],
    0
)

// Outlier Detection (beyond 2 standard deviations)
Is 5G Outlier = IF(ABS([5G Z-Score]) > 2, "Outlier", "Normal")

Total States = DISTINCTCOUNT('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[geography_id])

Avg Total Area = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area])

Total Coverage Area = SUM('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area])

Avg 3G Coverage = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_3g_area_st_pct])
Avg 4G Coverage = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct])


Avg 5G Speed1 Coverage = 
AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct])

Avg 5G Speed2 Coverage = 
AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd2_area_st_pct])

States with High 5G = 
CALCULATE(
    DISTINCTCOUNT('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[geography_id]),
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] > 0.5
)

4G Gap = [mobilebb_4g_area_st_pct] - [mobilebb_4g_area_iv_pct]

5G Speed1 Gap = [mobilebb_5g_spd1_area_st_pct] - [mobilebb_5g_spd1_area_iv_pct]

Avg Total Gap = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[4G Gap]) + AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G Speed1 Gap])

States Avg 5G = 
CALCULATE(
    [Avg 5G Speed1 Coverage],
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[geography_id] <= 56
)

Territories Avg 5G = 
CALCULATE(
    [Avg 5G Speed1 Coverage],
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[geography_id] > 56
)

State-Territory Gap = [States Avg 5G] - [Territories Avg 5G]

Territory Lag = 
IF([Geography Type] = "Territory",
   [States Avg 5G] - 'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct],
   BLANK()
)

Territories Below Avg = 
CALCULATE(
    COUNTROWS('YourTableName'),
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[geography_id] > 56,
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] < [States Avg 5G]
)

3G to 4G Jump = [Avg 4G Coverage] - [Avg 3G Coverage]
4G to 5G Speed1 Jump = [Avg 5G Speed1 Coverage] - [Avg 4G Coverage]
5G Speed1 to Speed2 Jump = [Avg 5G Speed2 Coverage] - [Avg 5G Speed1 Coverage]


Tech Maturity Score = 
('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_3g_area_st_pct] * 10) +
('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] * 30) +
('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] * 40) +
('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd2_area_st_pct] * 20)

// States with complete progression
Has All Technologies = 
IF(
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_3g_area_st_pct] > 0 &&
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] > 0 &&
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] > 0,
    "All Technologies",
    "Incomplete"
)

// Technology leapfrogging (states that skipped 3G)
Leapfrogged 3G = 
IF(
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_3g_area_st_pct] = 0 &&
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] > 0,
    "Yes",
    "No"
)


4G-5G SP1 Correlation = 
VAR Avg4G = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct])
VAR Avg5GSp1 = [5G Mean]
VAR Numerator = 
    SUMX(
        'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)',
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] - Avg4G) *
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - Avg5GSp1)
    )
VAR Denominator4G = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] - Avg4G, 2))
VAR Denominator5GSp1 = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - Avg5GSp1, 2))
RETURN
DIVIDE(Numerator, SQRT(Denominator4G * Denominator5GSp1), 0)

4G-5G SP2 Correlation = 
VAR Avg4G = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct])
VAR Avg5GSp2 = [5G Speed 2 Mean]
VAR Numerator = 
    SUMX(
        'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)',
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] - Avg4G) *
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd2_area_st_pct] - Avg5GSp2)
    )
VAR Denominator4G = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_4g_area_st_pct] - Avg4G, 2))
VAR Denominator5GSp2 = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd2_area_st_pct] - Avg5GSp2, 2))
RETURN
DIVIDE(Numerator, SQRT(Denominator4G * Denominator5GSp2), 0)

5G Coefficient of Variation = DIVIDE([5G Standard Deviation], [5G Mean], 0)

Area-Coverage Relationship = 
VAR AvgArea = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area])
VAR AvgCoverage = [Avg 5G Speed1 Coverage]
VAR Numerator = 
    SUMX(
        'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)',
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] - AvgArea) *
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - AvgCoverage)
    )
VAR DenominatorArea = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] - AvgArea, 2))
VAR DenominatorCoverage = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - AvgCoverage, 2))
RETURN
DIVIDE(Numerator, SQRT(DenominatorArea * DenominatorCoverage), 0)

Area-Coverage Speed1 Correlation = 
VAR AvgSp1Area = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area])
VAR AvgSp1Coverage = [5G Mean]
VAR NumeratorSp1 = 
    SUMX(
        'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)',
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] - AvgSp1Area) *
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - AvgSp1Coverage)
    )
VAR DenominatorSp1Area = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] - AvgSp1Area, 2))
VAR DenominatorSp1Coverage = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - AvgSp1Coverage, 2))
RETURN
DIVIDE(NumeratorSp1, SQRT(DenominatorSp1Area * DenominatorSp1Coverage), 0)

Area-Coverage Speed2 Correlation = 
VAR AvgSp2Area = AVERAGE('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area])
VAR AvgSp2Coverage = [5G Speed 2 Mean]
VAR NumeratorSp2 = 
    SUMX(
        'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)',
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] - AvgSp2Area) *
        ('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd2_area_st_pct] - AvgSp2Coverage)
    )
VAR DenominatorSp2Area = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] - AvgSp2Area, 2))
VAR DenominatorSp2Coverage = 
    SUMX('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', POWER('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd1_area_st_pct] - AvgSp2Coverage, 2))
RETURN
DIVIDE(NumeratorSp2, SQRT(DenominatorSp2Area * DenominatorSp2Coverage), 0)

Avg Coverage by Size = 
CALCULATE(
    [Avg 5G Speed1 Coverage],
    ALLEXCEPT('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)', 'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[State Size Category])
)

Gap Severity = 
SWITCH(
    TRUE(),
    [5G Speed1 Gap] > 0.20, "High Gap",
    [5G Speed1 Gap] > 0.10, "Moderate Gap",
    [5G Speed1 Gap] > 0.05, "Low Gap",
    "Minimal Gap"
)

State Size Category = 
SWITCH(
    TRUE(),
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] > 200000, "Very Large (>200K)",
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] > 100000, "Large (100-200K)",
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] > 50000, "Medium (50-100K)",
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[total_area] > 10000, "Small (10-50K)",
    "Very Small (<10K)"
)

5G Speed 2 Coverage Distribution = 
VAR CV = [5G Speed 2 Coefficient of Variation]
RETURN
SWITCH(
    TRUE(),
    CV < 0.15, "Very Consistent",
    CV < 0.30, "Moderately Consistent",
    CV < 0.50, "Variable",
    "Highly Variable"
)

5G SP2 Z-Score = 
VAR State2Mean = CALCULATE([5G Speed 2 Mean], ALL('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'))
VAR StateStd2Dev = CALCULATE([5G Speed 2 Standard Deviation], ALL('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'))
RETURN
DIVIDE(
    'bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[mobilebb_5g_spd2_area_st_pct] - State2Mean,
    StateStd2Dev,
    0
)

Outlier Status SP1 = 
SWITCH(
    TRUE(),
    ABS('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G SP1 Z-Score]) > 2.5, "Extreme Outlier",
    ABS('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G SP1 Z-Score]) > 2.0, "Moderate Outlier",
    ABS('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G SP1 Z-Score]) > 1.5, "Mild Outlier",
    "Normal"
)

Outlier Status SP2 = 
SWITCH(
    TRUE(),
    ABS('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G SP2 Z-Score]) > 2.5, "Extreme Outlier",
    ABS('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G SP2 Z-Score]) > 2.0, "Moderate Outlier",
    ABS('bdc_us_mobile_broadband_summary_by_geography_J25_30dec2025 (2)'[5G SP2 Z-Score]) > 1.5, "Mild Outlier",
    "Normal"
)
